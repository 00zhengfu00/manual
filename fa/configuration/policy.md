---
refcn: chapter_02/policy
refen: configuration/policy
---
# سیاست محلی

خط مشی محلی سیاست تنظیمات فعلی V2Ray را مدیریت می کند، مانند وقفه اتصال. پلیس میتواند به هر سطح کاربری یا کل سیستم اعمال شود.

## PolicyObject

`PolicyObject` به عنوان `فیلد` سیاست در پیکربندی سطح بالا استفاده می شود.

```javascript
{
  "levels": {
    "0": {
      "handshake": 4,
      "connIdle": 300,
      "uplinkOnly": 2,
      "downlinkOnly": 5,
      "statsUserUplink": false,
      "statsUserDownlink": false
    }
  },
  "system": {
    "statsInboundUplink": false,
    "statsInboundDownlink": false
  }
}
```

جایی که:

* `سطح`: لیستی از جفت های ارزش کلیدی. هر کلید یک رشته از عدد صحیح (محدود شده توسط JSON) است، مانند `"0"`, `"1"`، و غیره. مقدار عددی برای یک سطح مشخص کاربر است. هر مقدار دارای ویژگی های زیر است: 
  * `دستشویی`: زمان اتصال برای ایجاد یک ثانیه، در ثانیه است. مقدار پیش فرض `4`.
  * `conn1dle`: مدت زمان اتصال اتصالات خالی، در ثانیه. مقدار پیش فرض `300`.
  * `uplinkOnly`: زمان برای نگه داشتن اتصالات باز پس از اتصال بالا بسته در ثانیه است. مقدار پیش فرض `2`.
  * `downlinkOnly`: زمان برای نگه داشتن اتصالات پس از اتصال پایین بسته اتصال، در ثانیه است. مقدار پیش فرض `5`.
  * `statsUserUplink`: هنگامی که به `true`، V2Ray قادر به مقابله با ترافیک uplink برای تمام کاربران در این سطح است.
  * `statsUserDownlink`: هنگام تنظیم `true`، V2Ray قادر به مقابله با ترافیک downlink برای تمام کاربران در این سطح است.
  * `bufferSize` (V2Ray 3.24+): اندازه حافظه داخلی در هر اتصال، در کیلو بایت. مقدار پیش فرض `10240`. وقتی که `0`، بافر داخلی غیرفعال است.
* `سیستم` (V2Ray 3.18 +): سیاست سیستم برای V2Ray 
  * `statsInboundUplink` (V2Ray 3.18+): هنگامی که به `true`، V2Ray قادر به مقابله stat برای تمام ترافیک بالا در تمام پروکسی های ورودی می باشد.
  * `statsInboundDownlink` (V2Ray 3.18+): هنگامی که به `true`، V2Ray قادر به مقابله با آمار برای تمام ترافیک downlink در تمام پروکسی های ورودی است.

برخی از جزئیات زمانی که V2Ray اتصالات را مدیریت می کند:

1. در مرحله دست دادن یک ورودی پروکسی با یک اتصال جدید، می گویند VMess خواندن هدر درخواست، اگر بیش از آن طول می کشد `دست دادن` زمان، V2Ray بینتیجه میگذارد اتصال.
2. اگر هیچ داده تصویب از طریق اتصال در آن وجود دارد `connIdle` زمان، V2Ray بینتیجه میگذارد conneciton.
3. بعد از کلاینت (مرورگر) لینک uplink از اتصال را قطع می کند، V2Ray پس از `downlinkOnly` زمان را قطع می کند.
4. پس از راه اندازی (سرور) اتصال پایین اتصال را متوقف می کند، اتصال V2Ray پس از `uplinkOnly` بار را قطع می کند.

## نکات {#tips}

* هر اتصال ورودی و خروجی می تواند سطح کاربر را اعمال کند. V2Ray خط مشی مربوطه را بر اساس سطح کاربر اعمال می کند.
* `bufferSize` بروز `v2ray.ray.buffer.size` تنظیمات در [متغیر env](env.md#cache-size-per-connection).